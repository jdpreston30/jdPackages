# docker-compose.yml — {{PROJECT_NAME}}
# Generated by jdPackages::repo_template()
#
# Usage:
#   docker compose build     — build the image (first time or after package changes)
#   docker compose up        — run the full pipeline
#   docker compose run r bash — open an interactive shell inside the container
#
# Outputs are written to ./Outputs/ on the host via the volume mount.
# Edit the environment section to pass config overrides if needed.

services:
  r:
    build:
      context: .
      dockerfile: Dockerfile
    image: {{PROJECT_NAME}}:latest
    volumes:
      # Mount Outputs so results are accessible on the host after the run
      - ./Outputs:/analysis/Outputs
      # Optional: mount metadata_files if they are not bundled in the image
      # - ./metadata_files:/analysis/metadata_files
    environment:
      - R_PROFILE_USER=/analysis/.Rprofile
    command: ["Rscript", "-e", "source('All_Run/run.R')"]
